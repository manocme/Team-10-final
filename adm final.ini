<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ancient vs. Modern Temple Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(to bottom, #0F172A, #1E293B);
            color: #E2E8F0;
            line-height: 1.6;
            overflow-x: hidden;
        }
        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fadeInUp {
            animation: fadeInUp 0.8s ease-out forwards;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #1E293B;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            transform: translateY(-50px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        .modal-overlay.open .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #E2E8F0;
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="max-w-7xl mx-auto space-y-12">

        <!-- Header -->
        <header class="text-center py-12 px-4 md:px-8 bg-slate-900 rounded-3xl shadow-2xl border border-slate-700 animate-fadeInUp">
            <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold text-slate-200 mb-2">Ancient vs. Modern Temple Architecture</h1>
            <p class="text-xl sm:text-2xl text-slate-400 italic">A Tale of Two Sacred Marvels</p>
        </header>

        <!-- Intro -->
        <div class="p-6 md:p-10 bg-slate-800 rounded-2xl shadow-lg border border-slate-700 animate-fadeInUp">
            <p class="text-lg sm:text-xl text-center">
                Traditional Hindu temple architecture, as exemplified by the <strong class="text-cyan-400">Brihadisvara Temple</strong> in Thanjavur, and modern monumental sculpture, such as the <strong class="text-cyan-400">Adiyogi Shiva bust</strong> in Coimbatore, represent two distinct yet spiritually aligned approaches to sacred design in India. While both serve as symbols of Hindu deities, they differ significantly in their construction, purpose, and aesthetic.
            </p>
        </div>

        <!-- Comparison Sections -->
        <div class="grid lg:grid-cols-2 gap-8 lg:gap-12 animate-fadeInUp">

            <!-- Brihadisvara Temple Section -->
            <!-- NOTE: The href is purely visual since external files cannot be loaded in this single-file environment. -->
            <a href="brihadisvara.html" class="block bg-slate-800 rounded-3xl p-6 lg:p-10 shadow-lg border border-slate-700 space-y-6 transform transition duration-300 hover:scale-105">
                <h2 class="text-3xl sm:text-4xl font-bold text-center text-orange-300">Brihadisvara Temple: A Chola Masterpiece</h2>
                <div class="w-full h-64 bg-slate-700 rounded-xl flex items-center justify-center shadow-inner overflow-hidden">
                    <div class="text-center">
                        <i class="fas fa-landmark text-5xl text-slate-500 mb-4"></i>
                        <p class="text-slate-400">Brihadisvara Temple Placeholder</p>
                    </div>
                </div>
                <p class="text-base sm:text-lg text-slate-300">
                    Built by the Chola king Rajaraja I between 1003 and 1010 CE, the Brihadisvara Temple is a masterpiece of Dravidian architecture and a UNESCO World Heritage Site. It stands as a testament to the engineering and artistic prowess of the Chola Empire, a grand "house" built for the deity.
                </p>
                
                <div class="space-y-4">
                    <div class="p-4 bg-slate-700 rounded-xl flex items-start space-x-4 border border-slate-600 transition duration-300 hover:bg-slate-600">
                        <i class="fas fa-hammer text-orange-300 text-2xl mt-1"></i>
                        <div>
                            <h3 class="font-bold text-lg text-white">Materials & Construction</h3>
                            <p class="text-slate-300">This temple is an astonishing feat of engineering, constructed almost entirely from hand-carved *granite. Its most remarkable feature is the towering 63-meter-tall *vimana, capped by a single, monolithic *80-ton* stone. This massive stone was reportedly moved into place using an elaborate, kilometer-long earthen ramp.</p>
                        </div>
                    </div>
                    <div class="p-4 bg-slate-700 rounded-xl flex items-start space-x-4 border border-slate-600 transition duration-300 hover:bg-slate-600">
                        <i class="fas fa-archway text-orange-300 text-2xl mt-1"></i>
                        <div>
                            <h3 class="font-bold text-lg text-white">Architectural Style</h3>
                            <p class="text-slate-300">The design follows strict, traditional Hindu principles, with a complex, symmetrical layout. The entire structure is covered in intricate, narrative sculptures of deities, mythical beings, and scenes from the epics. Inside, the massive Shiva linga occupies two stories of the sanctum, and the walls of the upper corridor are carved with *81 of the 108 dance poses (karanas)* from the Natya Shastra.</p>
                    </div>
                    </div>
                    <div class="p-4 bg-slate-700 rounded-xl flex items-start space-x-4 border border-slate-600 transition duration-300 hover:bg-slate-600">
                        <i class="fas fa-pray text-orange-300 text-2xl mt-1"></i>
                        <div>
                            <h3 class="font-bold text-lg text-white">Purpose</h3>
                            <p class="text-slate-300">Beyond a place of worship, the temple served as the central hub of a thriving kingdom, where religious, social, and economic activities revolved around it. Its grand scale was a symbol of Chola power and devotion.</p>
                    </div>
                    </div>
                </div>
            </a>

            <!-- Adiyogi Shiva Bust Section -->
            <div class="bg-slate-800 rounded-3xl p-6 lg:p-10 shadow-lg border border-slate-700 space-y-6 transform transition duration-300 hover:scale-105">
                <h2 class="text-3xl sm:text-4xl font-bold text-center text-blue-400">Adiyogi Shiva Bust: A Modern Inspiration</h2>
                <div class="w-full h-64 bg-slate-700 rounded-xl flex items-center justify-center shadow-inner overflow-hidden">
                    <div class="text-center">
                        <i class="fas fa-monument text-5xl text-slate-500 mb-4"></i>
                        <p class="text-slate-400">Adiyogi Shiva Bust Placeholder</p>
                    </div>
                </div>
                <p class="text-base sm:text-lg text-slate-300">
                    The Adiyogi Shiva bust is a colossal steel monument inaugurated in 2017 by Prime Minister Narendra Modi. Designed by Sadhguru of the Isha Foundation, it represents a new, minimalist approach to sacred design, prioritizing a direct message of spiritual transformation.
                </p>
                
                <div class="space-y-4">
                    <div class="p-4 bg-slate-700 rounded-xl flex items-start space-x-4 border border-slate-600 transition duration-300 hover:bg-slate-600">
                        <i class="fas fa-cogs text-blue-400 text-2xl mt-1"></i>
                        <div>
                            <h3 class="font-bold text-lg text-white">Materials & Construction</h3>
                            <p class="text-slate-300">This modern marvel is constructed entirely from *steel*, a material that allows for rapid, prefabricated assembly. The smooth, unembellished surface is a deliberate departure from traditional, intricate carvings, reflecting a focus on simplicity and a modern aesthetic.</p>
                    </div>
                    </div>
                    <div class="p-4 bg-slate-700 rounded-xl flex items-start space-x-4 border border-slate-600 transition duration-300 hover:bg-slate-600">
                        <i class="fas fa-hand-holding-heart text-blue-400 text-2xl mt-1"></i>
                        <div>
                            <h3 class="font-bold text-lg text-white">Symbolism & Design</h3>
                            <p class="text-slate-300">The bust's monumental *112-foot height* is not arbitrary; it symbolizes the *112 paths to liberation* (moksha) mentioned in yogic scriptures. Rather than a complex temple plan, the monument's design is focused on a singular form, emphasizing the idea of inner well-being and self-realization.</p>
                    </div>
                    </div>
                    <div class="p-4 bg-slate-700 rounded-xl flex items-start space-x-4 border border-slate-600 transition duration-300 hover:bg-slate-600">
                        <i class="fas fa-lightbulb text-blue-400 text-2xl mt-1"></i>
                        <div>
                            <h3 class="font-bold text-lg text-white">Purpose</h3>
                            <p class="text-slate-300">Unlike the ancient temples, Adiyogi is not primarily a place for traditional ritual worship. It is an *"iconic inspiration"*, a cultural landmark intended to draw people toward the path of yoga. It uses modern technology, like a 3D laser light and sound show, to engage visitors and convey its spiritual message.</p>
                    </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Comparative Analysis Section -->
        <div class="comparison-section bg-slate-800 rounded-3xl p-6 lg:p-10 shadow-lg border border-slate-700 space-y-6 animate-fadeInUp">
            <h2 class="text-3xl sm:text-4xl font-bold text-center mb-4 text-slate-200">Comparative Analysis</h2>
            <p class="text-base sm:text-lg text-slate-300 text-center max-w-4xl mx-auto">
                The contrast between these two monuments highlights a significant evolution in sacred architecture. The ancient Brihadisvara Temple is a testament to timeless craftsmanship and tradition, while the modern Adiyogi statue embraces new materials and a direct, symbolic message to resonate with a contemporary audience.
            </p>
            <div class="overflow-x-auto mt-6">
                <table class="w-full text-left border-collapse rounded-xl">
                    <thead>
                        <tr class="bg-slate-700">
                            <th class="p-4 text-white rounded-tl-xl">Feature</th>
                            <th class="p-4 text-white">Brihadisvara Temple</th>
                            <th class="p-4 text-white rounded-tr-xl">Adiyogi Shiva Bust</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-t border-slate-700 hover:bg-slate-700 transition-colors duration-200">
                            <td class="p-4 font-semibold text-slate-200">Era</td>
                            <td class="p-4 text-slate-300">11th Century CE (Ancient)</td>
                            <td class="p-4 text-slate-300">21st Century CE (Modern)</td>
                        </tr>
                        <tr class="border-t border-slate-700 hover:bg-slate-700 transition-colors duration-200">
                            <td class="p-4 font-semibold text-slate-200">Primary Material</td>
                            <td class="p-4 text-slate-300">Granite</td>
                            <td class="p-4 text-slate-300">Steel</td>
                        </tr>
                        <tr class="border-t border-slate-700 hover:bg-slate-700 transition-colors duration-200">
                            <td class="p-4 font-semibold text-slate-200">Design Philosophy</td>
                            <td class="p-4 text-slate-300">Traditional, symmetrical, "mini-cosmos"</td>
                            <td class="p-4 text-slate-300">Modern, minimalist, symbolic</td>
                        </tr>
                        <tr class="border-t border-slate-700 hover:bg-slate-700 transition-colors duration-200">
                            <td class="p-4 font-semibold text-slate-200">Height</td>
                            <td class="p-4 text-slate-300">63 meters</td>
                            <td class="p-4 text-slate-300">34 meters</td>
                        </tr>
                        <tr class="border-t border-slate-700 hover:bg-slate-700 transition-colors duration-200">
                            <td class="p-4 font-semibold text-slate-200">Main Purpose</td>
                            <td class="p-4 text-slate-300">Ritual worship and housing a deity</td>
                            <td class="p-4 text-slate-300">Inspiration for the path of yoga</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pros and Cons Table -->
            <div class="overflow-x-auto mt-8">
                <h3 class="text-2xl sm:text-3xl font-bold text-center mb-4 text-slate-200">Pros and Cons</h3>
                <table class="w-full text-left border-collapse rounded-xl">
                    <thead>
                        <tr class="bg-slate-700">
                            <th class="p-4 text-white rounded-tl-xl">Aspect</th>
                            <th class="p-4 text-white">Ancient Architecture (Brihadisvara)</th>
                            <th class="p-4 text-white rounded-tr-xl">Modern Architecture (Adiyogi)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-t border-slate-700 hover:bg-slate-700 transition-colors duration-200">
                            <td class="p-4 font-semibold text-slate-200">Pros</td>
                            <td class="p-4 text-slate-300">Timeless artistry, extreme durability of granite, rich cultural and spiritual symbolism, intricate hand-carved details.</td>
                            <td class="p-4 text-slate-300">Rapid construction time, modern materials (steel), lower cost, global appeal, direct symbolic message, interactive features like light shows.</td>
                        </tr>
                        <tr class="border-t border-slate-700 hover:bg-slate-700 transition-colors duration-200">
                            <td class="p-4 font-semibold text-slate-200">Cons</td>
                            <td class="p-4 text-slate-300">Extremely labor-intensive and time-consuming, requires immense resources, limited by ancient technology.</td>
                            <td class="p-4 text-slate-300">Lacks the timeless, intricate craftsmanship of stone, may be seen as less sacred or traditional by purists.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Gemini API Features Section -->
        <div class="bg-slate-800 rounded-3xl p-6 lg:p-10 shadow-lg border border-slate-700 space-y-6 animate-fadeInUp">
            <h2 class="text-3xl sm:text-4xl font-bold text-center text-slate-200">Gemini-Powered Features ✨</h2>
            
            <!-- Itinerary and Chat Buttons -->
            <div class="grid sm:grid-cols-2 gap-4">
                <button id="itinerary-btn" class="py-4 px-6 rounded-xl bg-orange-500 text-white font-bold hover:bg-orange-600 transition-colors duration-200 disabled:opacity-50">Generate Itinerary ✨</button>
                <button id="chat-btn" class="py-4 px-6 rounded-xl bg-blue-500 text-white font-bold hover:bg-blue-600 transition-colors duration-200 disabled:opacity-50">Ask a Question 💬</button>
            </div>
            
            <!-- Image Generation Feature -->
            <div class="p-6 bg-slate-700 rounded-2xl border border-slate-600 space-y-4">
                <h3 class="text-xl font-bold text-slate-200">Generate an Architectural Image</h3>
                <div class="flex space-x-2">
                    <input type="text" id="image-prompt" class="flex-grow p-3 rounded-xl bg-slate-900 border border-slate-600 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="e.g., An abstract painting of a futuristic temple">
                    <button id="image-btn" class="py-3 px-6 rounded-xl bg-purple-500 text-white font-bold hover:bg-purple-600 transition-colors duration-200 disabled:opacity-50">Generate Image</button>
                </div>
                <div id="image-output" class="mt-4 p-4 rounded-xl bg-slate-800 border border-slate-600 flex items-center justify-center min-h-[300px]">
                    <p class="text-slate-400">Your generated image will appear here.</p>
                </div>
            </div>

            <!-- Trivia Feature -->
            <div class="p-6 bg-slate-700 rounded-2xl border border-slate-600 space-y-4">
                <h3 class="text-xl font-bold text-slate-200">Get an Architectural Fact</h3>
                <button id="trivia-btn" class="w-full py-3 px-6 rounded-xl bg-teal-500 text-white font-bold hover:bg-teal-600 transition-colors duration-200 disabled:opacity-50">Get a Fact!</button>
                <div id="trivia-output" class="mt-4 p-4 rounded-xl bg-slate-800 border border-slate-600 text-slate-300">
                    <p class="text-slate-400">A fascinating fact will appear here.</p>
                </div>
            </div>
        </div>

        <!-- Learn More Section -->
        <div class="p-6 md:p-10 bg-slate-800 rounded-3xl shadow-lg border border-slate-700 text-center animate-fadeInUp">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-slate-200">Learn More</h2>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-6 sm:gap-12">
                <a href="https://en.wikipedia.org/wiki/Brihadisvara_Temple" target="_blank" class="flex flex-col items-center group">
                    <i class="fas fa-book-open text-3xl text-orange-300 group-hover:text-orange-400 transition-colors duration-200"></i>
                    <p class="mt-2 text-slate-300 group-hover:text-white transition-colors duration-200">Brihadisvara Temple (Wikipedia)</p>
                </a>
                <a href="https://isha.sadhguru.org/us/en/wisdom/sadhguru-spot/adiyogi-shiva" target="_blank" class="flex flex-col items-center group">
                    <i class="fas fa-external-link-alt text-3xl text-blue-400 group-hover:text-blue-500 transition-colors duration-200"></i>
                    <p class="mt-2 text-slate-300 group-hover:text-white transition-colors duration-200">Adiyogi at Isha Foundation</p>
                </a>
                <a href="https://en.wikipedia.org/wiki/Adiyogi_Shiva_bust" target="_blank" class="flex flex-col items-center group">
                    <i class="fas fa-book-open text-3xl text-blue-400 group-hover:text-blue-500 transition-colors duration-200"></i>
                    <p class="mt-2 text-slate-300 group-hover:text-white transition-colors duration-200">Adiyogi Shiva Bust (Wikipedia)</p>
                </a>
            </div>
        </div>
        
    </div>

    <!-- Footer -->
    <footer class="text-center py-8 mt-12 text-slate-500 border-t border-slate-700 animate-fadeInUp">
        <p>&copy; 2025 Modern Architectural Comparison</p>
    </footer>

    <!-- Full-screen Modal -->
    <div id="api-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-btn">&times;</button>
            <div id="modal-title" class="text-3xl font-bold text-center mb-6"></div>
            <div id="modal-body" class="prose prose-invert max-w-none"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const itineraryBtn = document.getElementById('itinerary-btn');
            const chatBtn = document.getElementById('chat-btn');
            const imageBtn = document.getElementById('image-btn');
            const triviaBtn = document.getElementById('trivia-btn');
            const imagePromptInput = document.getElementById('image-prompt');
            const imageOutput = document.getElementById('image-output');
            const triviaOutput = document.getElementById('trivia-output');
            
            const modal = document.getElementById('api-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            const closeBtn = document.querySelector('.close-btn');

            // NOTE: The API Key is intentionally left as an empty string ("").
            // It will be automatically provided at runtime in this environment.
            const apiKey = ""; 
            const textModel = "gemini-2.5-flash-preview-09-2025";
            const imageModel = "imagen-3.0-generate-002";
            
            const textApiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${textModel}:generateContent?key=${apiKey}`;
            const imageApiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${imageModel}:predict?key=${apiKey}`;
            
            // Modal functionality
            const openModal = (title, content) => {
                modalTitle.textContent = title;
                modalBody.innerHTML = content;
                modal.classList.add('open');
            };

            const closeModal = () => {
                modal.classList.remove('open');
            };

            closeBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });

            // Loading state for buttons
            const setLoading = (button, isLoading) => {
                // Check if the button has already been clicked and is currently disabled
                if (isLoading) {
                    button.disabled = true;
                    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
                } else {
                    button.disabled = false;
                    // Reset inner HTML based on button ID
                    if (button.id === 'itinerary-btn') button.innerHTML = 'Generate Itinerary ✨';
                    else if (button.id === 'chat-btn') button.innerHTML = 'Ask a Question 💬';
                    else if (button.id === 'image-btn') button.innerHTML = 'Generate Image';
                    else if (button.id === 'trivia-btn') button.innerHTML = 'Get a Fact!';
                }
            };

            // Generic API call for text with retry logic (exponential backoff)
            const callTextApi = async (prompt, retries = 3, delay = 1000) => {
                const payload = {
                    contents: [{ parts: [{ text: prompt }] }],
                    tools: [{ "google_search": {} }],
                };
                
                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(textApiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        if (!response.ok) {
                            // Check for rate limiting errors (often 429) to trigger backoff
                            if (response.status === 429 && i < retries - 1) {
                                await new Promise(resolve => setTimeout(resolve, delay));
                                delay *= 2; // Exponential backoff
                                continue; // Retry the request
                            }
                            throw new Error(`API call failed with status: ${response.status}`);
                        }
                        
                        const result = await response.json();
                        return result?.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I couldn't get a clear response. Please refine your query.";
                    } catch (error) {
                        console.error(`Attempt ${i + 1} failed:`, error);
                        if (i === retries - 1) {
                            return "Sorry, there was a persistent error communicating with the AI service. Please try again later.";
                        }
                        // Wait before next retry (only for generic errors that might resolve)
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2; 
                    }
                }
            };

            // Itinerary generation logic
            itineraryBtn.addEventListener('click', async () => {
                setLoading(itineraryBtn, true);
                const itineraryPrompt = "Create a detailed 3-day travel itinerary for a spiritual journey in Tamil Nadu, India. The itinerary should include visits to the Brihadisvara Temple in Thanjavur and the Adiyogi Shiva Bust in Coimbatore. For each day, suggest specific activities, places to visit, local cuisine to try, and the best way to travel between locations. Format the response clearly with markdown headings for each day.";
                const text = await callTextApi(itineraryPrompt);
                openModal('Spiritual Journey Itinerary', text);
                setLoading(itineraryBtn, false);
            });

            // Chat logic
            chatBtn.addEventListener('click', async () => {
                // Using custom modal prompt imitation since alert() and confirm() are forbidden
                const userQuery = prompt('Ask a question about either the Brihadisvara Temple or the Adiyogi Shiva Bust:');
                if (userQuery) {
                    setLoading(chatBtn, true);
                    const promptText = "Answer the following question about the Brihadisvara Temple or the Adiyogi Shiva Bust. Be informative and engaging: " + userQuery;
                    const response = await callTextApi(promptText);
                    openModal('Architectural Q&A', `<div class="p-4 bg-slate-700 rounded-lg mb-4"><strong>You:</strong> ${userQuery}</div><div class="p-4 bg-slate-700 rounded-lg"><strong>AI:</strong> ${response}</div>`);
                    setLoading(chatBtn, false);
                }
            });

            // Image generation logic with retry
            imageBtn.addEventListener('click', async () => {
                const prompt = imagePromptInput.value.trim();
                if (!prompt) {
                    imageOutput.innerHTML = '<p class="text-red-400">Please enter a prompt to generate an image.</p>';
                    return;
                }
                
                setLoading(imageBtn, true);
                imageOutput.innerHTML = '<div class="flex flex-col items-center justify-center space-y-4 min-h-[300px]"><i class="fas fa-spinner fa-spin text-5xl text-purple-400"></i><p class="text-purple-400">Generating your image...</p></div>';

                const payload = {
                    instances: [{ prompt: prompt }],
                    parameters: { "sampleCount": 1 }
                };

                const retries = 3;
                let delay = 1000;

                try {
                    for (let i = 0; i < retries; i++) {
                        const response = await fetch(imageApiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        if (!response.ok) {
                            if (response.status === 429 && i < retries - 1) {
                                await new Promise(resolve => setTimeout(resolve, delay));
                                delay *= 2; 
                                continue;
                            }
                            throw new Error(`Image API call failed with status: ${response.status}`);
                        }

                        const result = await response.json();
                        if (result.predictions && result.predictions.length > 0 && result.predictions[0].bytesBase64Encoded) {
                            const base64Data = result.predictions[0].bytesBase64Encoded;
                            const imageUrl = "data:image/png;base64," + base64Data;
                            imageOutput.innerHTML = '<img src="' + imageUrl + '" class="w-full h-auto max-h-[50vh] object-contain rounded-lg shadow-md" alt="Generated image based on the prompt">';
                            return; // Success, exit function
                        } else {
                            throw new Error("No image data returned.");
                        }
                    } catch (error) {
                        console.error('Error fetching image from API:', error);
                        if (i === retries - 1) {
                            imageOutput.innerHTML = '<p class="text-red-400">An error occurred while generating the image after several attempts. Please try a different prompt.</p>';
                        }
                        // If not the last attempt, wait and retry
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2;
                    }
                }
            } finally {
                    setLoading(imageBtn, false);
                }
            });
            
            // Trivia logic
            triviaBtn.addEventListener('click', async () => {
                setLoading(triviaBtn, true);
                const triviaPrompt = "Provide a concise, interesting, and lesser-known fact about ancient or modern Indian temple architecture. The fact should be a single paragraph, no more than three sentences.";
                const fact = await callTextApi(triviaPrompt);
                triviaOutput.innerHTML = '<p class="text-lg italic text-slate-200">"' + fact + '"</p>';
                setLoading(triviaBtn, false);
            });
        });
    </script>
</body>
</html>
